<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated Helldivers Battle Map</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; display: flex; flex-direction: column; height: 100vh; }
        #controls { padding: 15px; background-color: #2c3e50; color: white; text-align: center; }
        
        button {
            padding: 8px 15px;
            margin: 2px;
            cursor: pointer;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            font-weight: bold;
        }

        button:hover { background-color: #2980b9; }
        button.active { background-color: #e74c3c; }

        #map { flex-grow: 1; background-color: #1a1a1a; }

        .animated-unit {
            transition: transform 1.5s ease-in-out;
        }

        .unit-img {
            filter: drop-shadow(0 0 4px rgba(0,0,0,0.8));
        }

        .leaflet-marker-icon {
            transition: transform 1.5s ease-in-out, opacity 0.5s ease-in-out;
        }
    </style>

<title>Battle For Cyberstan Interactive Map</title>
<meta name="title" content="Battle For Cyberstan Interactive Map" />
<meta name="description" content="An interactive map detailing the events of the battle for Cyberstan in Helldivers 2" />

<meta property="og:type" content="website" />
<meta property="og:url" content="https://adeafblindman.github.io/Cyberstan/" />
<meta property="og:title" content="Battle For Cyberstan Interactive Map" />
<meta property="og:description" content="An interactive map detailing the events of the battle for Cyberstan in Helldivers 2" />
<meta property="og:image" content="https://raw.githubusercontent.com/adeafblindman/Cyberstan/refs/heads/main/assets/Thumbnail.webp" />

<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:url" content="https://adeafblindman.github.io/Cyberstan/" />
<meta property="twitter:title" content="Battle For Cyberstan Interactive Map" />
<meta property="twitter:description" content="An interactive map detailing the events of the battle for Cyberstan in Helldivers 2" />
<meta property="twitter:image" content="https://raw.githubusercontent.com/adeafblindman/Cyberstan/refs/heads/main/assets/Thumbnail.webp" />

</head>
<body>

    <div id="controls">
        <strong style="margin-right: 15px;">Operations Calendar:</strong>
        <button class="day-btn active" onclick="changeDay(0, this)">C Day 0</button>
        <button class="day-btn" onclick="changeDay(1, this)">C Day +1</button>
        <button class="day-btn" onclick="changeDay(2, this)">C Day +2</button>
        <button class="day-btn" onclick="changeDay(3, this)">C Day +3</button>
        <button class="day-btn" onclick="changeDay(4, this)">C Day +4</button>
        <button class="day-btn" onclick="changeDay(5, this)">C Day +5</button>
        <button class="day-btn" onclick="changeDay(6, this)">C Day +6</button>
        <button class="day-btn" onclick="changeDay(7, this)">C Day +7</button>
        <button class="day-btn" onclick="changeDay(8, this)">C Day +8</button>
        <button class="day-btn" onclick="changeDay(9, this)">C Day +9</button> 
        <button class="day-btn" onclick="changeDay(10, this)">C Day +10</button> 
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const battleData = {
            days: [
                { overlayUrl: './maps/BASE MAP.webp' }, { overlayUrl: './maps/BASE MAP.webp' },
                { overlayUrl: './maps/BASE MAP.webp' }, { overlayUrl: './maps/MAP-D3.webp' },
                { overlayUrl: './maps/MAP-D3.webp' }, { overlayUrl: './maps/MAP-D5.webp' },
                { overlayUrl: './maps/MAP-D5.webp' }, { overlayUrl: './maps/MAP-D5.webp' },
                { overlayUrl: './maps/MAP-D8.webp' }, { overlayUrl: './maps/MAP-D8.webp' },
                { overlayUrl: './maps/MAP-D8.webp' }
            ],
            units: [
                { id: '8th Army', name: '8th Army', iconUrl: 'icons/8th Army - Infantry - Army.svg', positions: [[110, 1136],[136, 1045],[206, 898],[269, 761],[299, 728],[374, 666],[475, 640],[475, 640],[570, 610],[650, 610],[650, 610]] },
                { id: '7th Army', name: '7th Army', iconUrl: 'icons/7th Army - Infantry - Army.svg', positions: [[110, 1136],[74, 984],[51, 835],[131, 695],[174, 627],[241, 511],[361, 421],[361, 421],[562, 344],[562, 344],[562, 344]] },
                { id: '68th AAD', name: '68th Air Assault Division', iconUrl: 'icons/68th Air Assault Division - Air Assault with Organic Lift - Division.svg', positions: [[110, 1136],[152, 1252],[208, 1319],[334, 1394],[359, 1498],[423, 1597],[494, 1620],[494, 1620],[541, 1647],[622, 1666],[622, 1666]] },
                { id: '23rd AAD', name: '23rd Air Assault Division', iconUrl: 'icons/23rd Air Assault Division - Air Assault with Organic Lift - Division.svg', positions: [[110, 1136],[94, 1210],[177, 1299],[319, 1339],[395, 1343],[478, 1352],[546, 1376],[546, 1376],[602, 1370],[602, 1370],[602, 1370]] },
                { id: '14th MAD', name: '14th Marine Assault Division', iconUrl: 'icons/14th Marine Assault Division - Marine - Division.svg', positions: [[110, 1136],[111, 1006],[107, 906],[176, 788],[207, 717],[282, 598],[408, 516],[408, 516],[459, 466],[459, 466],[459, 466]] },
                { id: '77th MI', name: '77th Mobile Infantry', iconUrl: 'icons/77th Mobile Infantry - Motorized.svg', positions: [[74, 456],[198, 454],[308, 458],[198, 454],[122, 378],[122, 378],[122, 378],[122, 378],[122, 378],[122, 378],[122, 378]] },
                { id: '4th Army', name: '4th Army', iconUrl: 'icons/4TH ARMY - Infantry - Army.svg', positions: [[110, 1136],[200, 1046],[284, 982],[342, 958],[362, 920],[422, 911],[512, 902],[512, 902],[582, 921],[682, 932], [682, 932]] },
                { id: '3rd Army', name: '3rd Army', iconUrl: 'icons/3rd Army - Infantry - Army.svg', positions: [[110, 1136],[226, 1181],[298, 1248],[414, 1239],[460, 1172],[494, 1135],[536, 1131],[536, 1131],[620, 1120],[780, 1110], [780, 1110]] },
                { id: '12th Armor', name: '12th Armor', iconUrl: 'icons/12TH ARMOR - Armored_Mechanized_Tracked.svg', spawnDay: 4, positions: [null, null, null, null, [362, 920], [330, 812], [452, 821], [496, 827], [611, 808], [672, 796], [672, 796]] },
                { id: '14th AR', name: '14th Air Recon', iconUrl: 'icons/14th Air Recon - Reconnaissance.svg', spawnDay: 8, positions: [null, null, null, null, null, null, null, null, [780, 1110], [860, 1282], [860, 1282]] },
                { id: 'HD1', name: 'HELLDIVER CORPS. 1', iconUrl: 'icons/HELLDIVER CORPS SKULL.svg', positions: [[110, 1136],[110, 1136],[110, 1136],[338, 812],[338, 812],[780, 1110],[780, 1110],[780, 1110],[900, 1666],[900, 1666],[900, 1666]] },
                { id: 'HD2', name: 'HELLDIVER CORPS. 2', iconUrl: 'icons/HELLDIVER CORPS SKULL.svg', positions: [[74, 456],[74, 456],[74, 456],[74, 456],[74, 456],[74, 456],[74, 456],[74, 456],[74, 456],[74, 456],[74, 456]] },
                { id: 'HD3', name: 'HELLDIVER CORPS. 3', iconUrl: 'icons/HELLDIVER CORPS SKULL.svg', spawnDay: 3, positions: [null, null, null, [500, 1486], [500, 1486], [500, 1486], [500, 1486], [500, 1486], [500, 1486], [500, 1486], [500, 1486]] },
                { id: 'HD4', name: 'HELLDIVER CORPS. 4', iconUrl: 'icons/HELLDIVER CORPS SKULL.svg', spawnDay: 5, positions: [null, null, null, null, null, [730, 192], [730, 192], [730, 192], [730, 192], [730, 192], [730, 192]] },
                { id: 'ammo cache1', name: 'AMMO CACHE', iconUrl: 'icons/ammo cache red.svg', spawnDay: 3, despawnDay: 3, positions: [null, null, null, [355, 934], null] },
                { id: 'ammo cache2', name: 'AMMO CACHE', iconUrl: 'icons/ammo cache blue.svg', spawnDay: 4, despawnDay: 4, positions: [null, null, null, [355, 934], [355, 934]] },
                { id: 'arty 1', name: '501st SEAF Artillery', iconUrl: 'icons/Artillery - Heavy.svg', spawnDay: 7, positions: [null, null, null, null, null, null, null, [466, 1018], [466, 1018], [466, 1018], [466, 1018]] },
                { id: 'arty 2', name: '56th Siege Regiment', iconUrl: 'icons/Artillery - Heavy.svg', spawnDay: 7, positions: [null, null, null, null, null, null, null, [458, 1244], [458, 1244], [458, 1244], [458, 1244]] },
                { id: 'arty 3', name: '2nd Artillery Company', iconUrl: 'icons/Artillery - Heavy.svg', spawnDay: 7, positions: [null, null, null, null, null, null, null, [478, 778], [525, 780], [525, 780], [525, 780]] },
                { id: '22nd Cavalry', name: '22nd Cavalry', iconUrl: 'icons/22nd CAV - Reconnaissance_Cavalry_Scout - Company.svg', spawnDay: 8, positions: [null, null, null, null, null, null, null, null, [780, 1110], [810, 1341], [810, 1341]] },
                { id: 'AUTO WEST', name: 'AUTOMATONS', iconUrl: 'icons/CYBORGS ICON.webp', positions: [[236, 466],[254, 388],[350, 370],[262, 450],[262, 450],[262, 450],[220, 348],[220, 348],[220, 348],[220, 348],[220, 348]] },
                { id: 'AUTO CENT', name: 'AUTOMATONS', iconUrl: 'icons/CYBORGS ICON.webp', despawnDay: 8, positions: [[272, 1130],[314, 1136],[354, 1130],[420, 1112],[528, 1136],[576, 1126],[606, 1128],[654, 1129],[721, 1117],[820, 1422],[940, 1614]] },
                { id: 'AUTO OMNIPARITUS', name: 'AUTOMATONS', iconUrl: 'icons/CYBORGS ICON.webp', despawnDay: 8, positions: [[168, 1034],[234, 992],[328, 926],[394, 900],[438, 906],[512, 892],[570, 860],[598, 850],[682, 868],[786, 786],[786, 786]] },
                { id: 'AUTO OMNIPARITUS SOUTH', name: 'AUTOMATONS', iconUrl: 'icons/CYBORGS ICON.webp', positions: [[168, 1034],[173, 945],[186, 824],[261, 684],[300, 653],[350, 590],[474, 506],[494, 476],[480, 216],[128, 302],[128, 302]] },
                { id: 'AUTO SOLIDARITET REINFORCE', name: 'AUTOMATONS', iconUrl: 'icons/CYBORGS ICON.webp', positions: [[168, 1034],[114, 914],[94, 730],[106, 574],[120, 512],[120, 512],[154, 530],[154, 530],[154, 530],[154, 530],[154, 530]] },
                { id: 'AUTO CAMRAT FOR', name: 'AUTOMATONS', iconUrl: 'icons/CYBORGS ICON.webp', positions: [[484, 62],[484, 62],[484, 62],[484, 62],[484, 62],[484, 62],[484, 62],[484, 62],[484, 62],[904, 1730],[904, 1730]] },
                { id: 'AUTO STAR JETS', name: 'JET BRIGADE', iconUrl: 'icons/Jet_Brigade_Icon.webp', spawnDay: 5, positions: [null, null, null, null, [792, 1196], [792, 1196], [792, 1196], [792, 1196], [918, 1602], [918, 1602], [918, 1602]] },
                { id: 'AUTO 911 FIRE', name: 'THE INCINERATION CORPS.', iconUrl: 'icons/THE INCINERATION CORPS.webp', spawnDay: 5, positions: [null, null, null, null, [758, 130], [758, 130], [758, 130], [758, 130], [758, 130], [948, 1736], [948, 1736]] }
            ],
            lines: [
                {
                    id: 'eastern-front',
                    color: '#000000',
                    positions: [
                        [[103, 1069], [186, 1047], [257, 1131],[201, 1202],[162, 1198],[113, 1179],[103, 1069]], // Day 0
                        [[5, 933], [95, 955], [156, 992],[223, 1005],[276, 1133],[240, 1227],[178, 1287],[120, 1299],[0, 1298]], // Day 1
                        [[5, 776],[68, 802],[101, 852],[217, 844],[305, 947],[331, 1062],[303, 1135],[333, 1244],[303, 1291],[233, 1357],[155, 1382],[2, 1391]], // Day 2
                        [[5, 584],[234, 711],[345, 761],[306, 919],[364, 968],[373, 1121],[439, 1200],[427, 1339],[384, 1496],[277, 1758],[221, 1918]], // Day 3
                        [[132, 564],[218, 632],[339, 735],[346, 816],[399, 927],[491, 1148],[429, 1360],[385, 1516],[266, 1918]], // Day 4
                        [[196, 475],[259, 484],[306, 591],[330, 624],[395, 630],[474, 916],[527, 1143],[522, 1376],[459, 1477],[474, 1611],[415, 1918]], // Day 5
                        [[188, 475],[338, 313],[417, 452],[447, 561],[539, 652],[492, 818],[541, 885],[563, 1131],[587, 1407],[549, 1430],[505, 1521],[524, 1629],[449, 1919]], // Day 6
                        [[192, 475],[361, 317],[447, 490],[541, 639],[550, 873],[541, 1011],[597, 1132],[561, 1241],[596, 1378],[526, 1433],[510, 1539],[507, 1919]], // Day 7
                        [[187, 475],[424, 255],[610, 270],[536, 464],[651, 620],[594, 721],[656, 807],[631, 921],[620, 1026],[662, 1115],[647, 1269],[638, 1383],[568, 1431],[505, 1541],[603, 1918]], // Day 8
                        [[193, 475],[442, 238],[582, 248],[705, 593],[732, 932],[799, 1103],[912, 1282],[781, 1458],[671, 1598],[671, 1764],[655, 1919],], // Day 9
                        [[],]  // Day 10
                    ]
                },
                {
                    id: 'western-front',
                    color: '#000000',
                    positions: [
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        [[35, 386], [132, 382], [191, 477], [131, 563], [37, 560], [35, 386]], // Day 0
                        

                    ]
                }
            ]
        };

        const bounds = [[0, 0], [1080, 1920]]; 
        const map = L.map('map', { crs: L.CRS.Simple, minZoom: -1, maxZoom: 2, maxBounds: bounds });
        
        L.imageOverlay('assets/Background.png', bounds).addTo(map);
        let tacticalOverlay = L.imageOverlay(battleData.days[0].overlayUrl, bounds, { opacity: 1, zIndex: 10 }).addTo(map);
        map.fitBounds(bounds);

        // Name overlay Marker
        const nameIcon = L.icon({ iconUrl: 'assets/NAME.png', iconSize: [640, 39], iconAnchor: [0, 0] });
        L.marker([0, 0], { icon: nameIcon, interactive: false, zIndexOffset: 1000 }).addTo(map);

        // --- Initialize Lines ---
        const lineLayers = {};
        battleData.lines.forEach(line => {
            const polyline = L.polyline(line.positions[0], {
                color: line.color,
                weight: 5,
                opacity: 0.6,
                dashArray: '10, 15', // Tactical dashed look
                interactive: false
            }).addTo(map);
            lineLayers[line.id] = polyline;
        });

        // --- Initialize Units ---
        const unitMarkers = {};
        battleData.units.forEach(unit => {
            const icon = L.divIcon({
                className: 'animated-unit',
                html: `<img src="${unit.iconUrl}" class="unit-img" style="width: 40px; height: 45px;" />`, 
                iconSize: [40, 45], iconAnchor: [20, 15]
            });
            const marker = L.marker(unit.positions[0] || [0,0], { icon: icon, zIndexOffset: 500 });
            marker.bindTooltip(unit.name, { direction: 'top', offset: [0, -15] });
            unitMarkers[unit.id] = marker;
            if (!unit.spawnDay || unit.spawnDay === 0) marker.addTo(map);
        });

        function changeDay(dayIndex, buttonElement) {
            document.querySelectorAll('.day-btn').forEach(btn => btn.classList.remove('active'));
            buttonElement.classList.add('active');
            tacticalOverlay.setUrl(battleData.days[dayIndex].overlayUrl);

            // --- Update Lines ---
            battleData.lines.forEach(line => {
                const layer = lineLayers[line.id];
                const newCoords = line.positions[dayIndex];
                if (layer && newCoords) {
                    layer.setLatLngs(newCoords);
                }
            });

            // --- Update Units (with wrap-around logic) ---
            battleData.units.forEach(unit => {
                const marker = unitMarkers[unit.id];
                const spawnDay = unit.spawnDay || 0;
                const despawnDay = unit.despawnDay !== undefined ? unit.despawnDay : 999;
                const isAlive = dayIndex >= spawnDay && dayIndex <= despawnDay;

                if (isAlive) {
                    if (!map.hasLayer(marker)) marker.addTo(map);
                    const newPos = unit.positions[dayIndex];
                    if (newPos) {
                        const wrapAroundUnits = ['AUTO 911 FIRE', 'AUTO CAMRAT FOR']; 
                        if (wrapAroundUnits.includes(unit.id) && dayIndex === 9) {
                            const day8_Y = unit.positions[8][0];
                            const day9_Y = newPos[0];
                            marker.setLatLng([day8_Y, -50]); 
                            setTimeout(() => {
                                if (marker._icon) {
                                    marker._icon.style.transition = 'none';
                                    marker.setLatLng([day9_Y, 1970]); 
                                    void marker._icon.offsetWidth; 
                                    marker._icon.style.transition = 'transform 1.5s ease-in-out';
                                    marker.setLatLng(newPos);
                                }
                            }, 1500);
                        } else {
                            if (marker._icon) marker._icon.style.transition = 'transform 1.5s ease-in-out';
                            marker.setLatLng(newPos);
                        }
                    }
                } else {
                    if (map.hasLayer(marker)) map.removeLayer(marker);
                }
            });
        }

        map.on('click', (e) => { console.log(`[${Math.round(e.latlng.lat)}, ${Math.round(e.latlng.lng)}]`); });
    </script>
</body>
</html>